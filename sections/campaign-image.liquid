{% comment %}
  Campaign Image Row - Single full-width image with optional flipper animation
  Used for homepage hero images and campaign rows
{% endcomment %}

{%- if section.settings.enable_section_css -%}
  {{ 'section-campaigns.css' | asset_url | stylesheet_tag }}
{%- endif -%}

<article class="campaign-row one flex{% if section.settings.enable_flipper %} ohmygaad{% endif %}">
  <div class="image">
    {%- if section.settings.link != blank -%}
      <a href="{{ section.settings.link }}">
    {%- endif -%}
    
    <div class="main_picture">
      <div class="picture_mask"></div>
      <div class="picture_outer">
        <div class="picture_inner">
          <picture>
            {%- if section.settings.mobile_image != blank -%}
              <source 
                srcset="{{ section.settings.mobile_image | image_url: width: 800 }}" 
                media="(max-width: 767px)">
            {%- endif -%}
            <img 
              class="faller" 
              src="{{ section.settings.desktop_image | image_url: width: 2048 }}"
              srcset="{{ section.settings.desktop_image | image_url: width: 768 }} 768w,
                      {{ section.settings.desktop_image | image_url: width: 1140 }} 1140w,
                      {{ section.settings.desktop_image | image_url: width: 1440 }} 1440w,
                      {{ section.settings.desktop_image | image_url: width: 2048 }} 2048w"
              sizes="100vw"
              alt="{{ section.settings.desktop_image.alt | default: section.settings.heading }}"
              loading="{% if section.settings.loading == 'eager' %}eager{% else %}lazy{% endif %}">
          </picture>
        </div>
      </div>
      
      {%- if section.settings.enable_flipper -%}
        <div class="flipper_outer">
          <div class="flipper-container">
            <div class="flipper_inner">
              <picture class="flipper">
                {%- if section.settings.flipper_image != blank -%}
                  {%- comment -%} Use custom flipper image if provided {%- endcomment -%}
                  {%- if section.settings.flipper_mobile_image != blank -%}
                    <source 
                      srcset="{{ section.settings.flipper_mobile_image | image_url: width: 800 }}" 
                      media="(max-width: 767px)">
                  {%- elsif section.settings.mobile_image != blank -%}
                    <source 
                      srcset="{{ section.settings.mobile_image | image_url: width: 800 }}" 
                      media="(max-width: 767px)">
                  {%- endif -%}
                  <img 
                    class="faller" 
                    src="{{ section.settings.flipper_image | image_url: width: 2048 }}"
                    srcset="{{ section.settings.flipper_image | image_url: width: 768 }} 768w,
                            {{ section.settings.flipper_image | image_url: width: 1140 }} 1140w,
                            {{ section.settings.flipper_image | image_url: width: 1440 }} 1440w,
                            {{ section.settings.flipper_image | image_url: width: 2048 }} 2048w"
                    sizes="100vw"
                    alt="{{ section.settings.flipper_image.alt | default: 'Flipper image' }}"
                    loading="lazy">
                {%- else -%}
                  {%- comment -%} Use same image as main if no flipper image provided {%- endcomment -%}
                  {%- if section.settings.mobile_image != blank -%}
                    <source 
                      srcset="{{ section.settings.mobile_image | image_url: width: 800 }}" 
                      media="(max-width: 767px)">
                  {%- endif -%}
                  <img 
                    class="faller" 
                    src="{{ section.settings.desktop_image | image_url: width: 2048 }}"
                    srcset="{{ section.settings.desktop_image | image_url: width: 768 }} 768w,
                            {{ section.settings.desktop_image | image_url: width: 1140 }} 1140w,
                            {{ section.settings.desktop_image | image_url: width: 1440 }} 1440w,
                            {{ section.settings.desktop_image | image_url: width: 2048 }} 2048w"
                    sizes="100vw"
                    alt="{{ section.settings.desktop_image.alt }}"
                    loading="lazy">
                {%- endif -%}
              </picture>
              <div class="mask"></div>
            </div>
          </div>
        </div>
      {%- endif -%}
    </div>
    
    {%- if section.settings.link != blank -%}
      </a>
    {%- endif -%}
  </div>
</article>

{% schema %}
{
  "name": "Campaign Image",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_section_css",
      "label": "Enable section CSS",
      "default": true
    },
    {
      "type": "header",
      "content": "Main Image"
    },
    {
      "type": "image_picker",
      "id": "desktop_image",
      "label": "Desktop image",
      "info": "2048px width recommended"
    },
    {
      "type": "image_picker",
      "id": "mobile_image",
      "label": "Mobile image (optional)",
      "info": "800px width recommended. Uses desktop image if not provided."
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "info": "Used for image alt text if alt not provided"
    },
    {
      "type": "select",
      "id": "loading",
      "label": "Image loading",
      "options": [
        {
          "value": "eager",
          "label": "Eager (for first image on page)"
        },
        {
          "value": "lazy",
          "label": "Lazy (default)"
        }
      ],
      "default": "lazy",
      "info": "Use 'Eager' for the first image on the page"
    },
    {
      "type": "header",
      "content": "Flipper Animation"
    },
    {
      "type": "checkbox",
      "id": "enable_flipper",
      "label": "Enable flipper animation",
      "default": false,
      "info": "Animated flip effect (5.6 second loop)"
    },
    {
      "type": "image_picker",
      "id": "flipper_image",
      "label": "Flipper image (optional)",
      "info": "Alternative image for flip animation. Uses main image if not provided."
    },
    {
      "type": "image_picker",
      "id": "flipper_mobile_image",
      "label": "Flipper mobile image (optional)",
      "info": "Mobile version of flipper image"
    },
    {
      "type": "header",
      "content": "Link"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link",
      "info": "Makes entire image clickable"
    }
  ],
  "presets": [
    {
      "name": "Campaign Image"
    }
  ]
}
{% endschema %}
